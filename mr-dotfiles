# ~/.config/mr/mr-dotfiles

[DEFAULT]
include =
	cat ~/.config/mr/mr-stow-plugin 2>/dev/null || true
	cat ~/.config/mr/mr-hooks 2>/dev/null || true
lib = . ~/.config/mr/mr-functions

# sync my repos on local & github
[.config/mr]
order = 1
name = mr-config
chain = true
checkout = git clone ssh://git@github.com/wandsas/mr-config.git $MR_REPO
remotes = git_add_remote local rpi3.homelab:/srv/git/wandsas/mr-config.git
fixups =
	ensure_symlink_exists ~/.mrconfig $MR_REPO/mr-dotfiles
	ensure_symlink_exists ~/.stow-global-ignore $MR_REPO/.stow-global-ignore

[$HOME/.GIT/vcs/kitenet-mr]
checkout = git clone ssh://git@github.com/wandsas/kitenet-mr.git $MR_REPO
remotes = git_add_remote local rpi3.homelab:/srv/git/kitenet-mr.git
fixups =
    [ -f /usr/local/bin/mr ] && return
    make build && make install
skip = lazy

[$HOME/.GIT/wandsas/dotfiles]
stowable = true
checkout = git clone ssh://git@github.com/wandsas/dotfiles.git
remotes = git_add_remote local rpi3.homelab:/srv/git/wandsas/dotfiles.git

[$HOME/.GIT/bsd/OpenDoas]
checkout = git clone git://github.com/Duncaen/OpenDoas.git $MR_REPO
remotes = git_add_remote local rpi3.homelab:/srv/git/OpenDoas.git
fixups = 
    [ -f /usr/local/bin/doas ] && return
    make clean
    ./configure --prefix=/usr/local
    make && make install
skip = ! my_user_host

[$HOME/.GIT/bsd/lobase]
checkout = git clone git://github.com/Duncaen/lobase.git $MR_REPO
remotes = git_add_remote local rpi3.homelab:/srv/git/lobase.git
fixups =
    make clean
    autoreconf -fi
    ./configure --prefix=/usr/local/lobase
    make && make install
skip = ! my_user_host

[$HOME/.GIT/vcs/diff-so-fancy]
checkout = git clone git://github.com/so-fancy/diff-so-fancy.git $MR_REPO
remotes = git_add_remote local rpi3.homelab:/srv/git/diff-so-fancy.git
fixups =
    [ -f ~/.local/bin/diff-so-fancy ] || \
        install -g users -m 755 -t diff-so-fancy ~/.local/bin/diff-so-fancy
    [ -f ~/.local/lib/perl/lib/DiffHighlight.pm ] || \
        install -g users -m 644 lib/DiffHighlight.pm ~/.local/lib/perl5/lib/DiffHighlight.pm
skip = ! my_user_host

[$HOME/.GIT/docker/docker-credential-helpers]
checkout = git clone git://github.com/docker/docker-credential-helpers.git $MR_REPO
remotes = git_add_remote local rpi3.homelab rpi3.homelab:/srv/git/docker-credential-helpers.git
fixups =
    [ -f ~/.local/bin/docker-credential-pass ] && return
    make clean && make pass
    install -g users -m 755 bin/docker-credential-pass ~/.local/bin/docker-credential-pass
skip = ! my_user_host

[$HOME/.GIT/gnome/gnome-keyring-query]
checkout = git clone ssh://git@github.com/wandsas/gnome-keyring-query.git $MR_REPO
remotes = git_add_remote local rpi3.homelab:/srv/git/gnome-keyring-query.git
fixups = [ -f ~/.local/bin/gnome-keyring-query ] || make
skip = ! my_user_host

[$HOME/.local/lib/rbenv]
checkout = git clone git://github.com/rbenv/rbenv.git $MR_REPO
skip = ! my_user_host

[$HOME/.local/lib/pyenv]
checkout = git clone git://github.com/pyenv/pyenv.git $MR_REPO
post_checkout =
fixups = cd $MR_REPO && src/configure && make -C src
skip = ! my_user_host

[$HOME/.local/lib/nvm]
checkout = git clone git://github.com/nvm-sh/nvm.git $MR_REPO
skip = ! my_user_host

# vim:fenc=utf-8:ft=dosini:ts=4:sts=4:sw=4:et:
